<div class="main-container contact-edit-container">

  <div class="main-header">
    <h1 class="title">
      <mat-icon mat-card-avatar>person</mat-icon>
      @if(isCreateMode){<span>Create Contact</span>}
      @if(isEditMode){<span>Edit Contact</span>}
      @if(isViewMode){<span>View Contact</span>}
    </h1>
    <div class="header-actions">
      <!-- Back button - always visible -->
      <button mat-raised-button (click)="onBack()">
        <mat-icon>arrow_back</mat-icon>
        Back
      </button>

      <!-- Cancel button - visible in create or edit mode -->
      <button mat-raised-button (click)="onCancel()" *ngIf="isCreateMode || isEditMode">
        <mat-icon>cancel</mat-icon>
        Cancel
      </button>

      <!-- Create button - visible in create mode -->
      <button mat-raised-button color="primary" (click)="onCreate()" *ngIf="isCreateMode"
        [disabled]="loading || contactForm.invalid">
        <mat-icon>save</mat-icon>
        Create
      </button>

      <!-- Edit button - visible in edit mode -->
      <button mat-raised-button color="primary" (click)="onEdit()" *ngIf="isEditMode"
        [disabled]="loading || contactForm.invalid">
        <mat-icon>save</mat-icon>
        Save
      </button>

      <!-- Duplicate button - visible in view mode -->
      <button mat-raised-button color="accent" (click)="onDuplicate()" *ngIf="isViewMode" [disabled]="loading">
        <mat-icon>content_copy</mat-icon>
        Duplicate
      </button>

      <!-- Delete button - visible in view mode -->
      <button mat-raised-button color="warn" (click)="onDelete()" *ngIf="isViewMode" [disabled]="loading">
        <mat-icon>delete</mat-icon>
        Delete
      </button>
    </div>
  </div>



  @if (error && !loading) {
  <div class="error-section">
    <mat-card>
      <mat-icon color="warn">error</mat-icon>
      <p>{{ error }}</p>
    </mat-card>
  </div>
  }

  @if (loading) {
  <div class="loading-section">
    <mat-spinner></mat-spinner>
    <p>Processing...</p>
  </div>
  }

  <mat-card class="form-card">
    <mat-card-content>
      <form [formGroup]="contactForm">

        <!-- Contact Details Section -->
        <div class="form-section">
          <h2 class="section-title">Contact Details</h2>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>First Name</mat-label>
              <input matInput formControlName="firstName" placeholder="Enter first name">
              <mat-error *ngIf="contactForm.get('firstName')?.hasError('required')">
                First name is required
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="lastName" placeholder="Enter last name">
              <mat-error *ngIf="contactForm.get('lastName')?.hasError('required')">
                Last name is required
              </mat-error>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Birth Date</mat-label>
              <input matInput type="date" formControlName="birthDate" placeholder="Select birth date">
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Holder Type</mat-label>
              <mat-select formControlName="holderType">
                <mat-option [value]="HolderTypeLvo.ACCOUNT">Account</mat-option>
                <mat-option [value]="HolderTypeLvo.CORPORATE">Corporate</mat-option>
              </mat-select>
              <mat-error *ngIf="contactForm.get('holderType')?.hasError('required')">
                Holder type is required
              </mat-error>
            </mat-form-field>
          </div>
        </div>

        <!-- Email Section -->
        <div class="form-section">
          <h2 class="section-title">Email</h2>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Email Address</mat-label>
              <input matInput type="email" formControlName="mainEmail" placeholder="Enter email">
              <mat-icon matPrefix>email</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Email Type</mat-label>
              <mat-select formControlName="mainEmailType">
                <mat-option [value]="EmailTypeLvo.PERSONAL">Personal</mat-option>
                <mat-option [value]="EmailTypeLvo.WORK">Work</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <!-- Phone Section -->
        <div class="form-section">
          <h2 class="section-title">Phone</h2>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Phone Number</mat-label>
              <input matInput formControlName="mainPhone" placeholder="Enter phone">
              <mat-icon matPrefix>phone</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Phone Type</mat-label>
              <mat-select formControlName="mainPhoneType">
                <mat-option [value]="PhoneTypeLvo.MOBILE">Mobile</mat-option>
                <mat-option [value]="PhoneTypeLvo.HOME">Home</mat-option>
                <mat-option [value]="PhoneTypeLvo.WORK">Work</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <!-- Address Section -->
        <div class="form-section">
          <h2 class="section-title">Address</h2>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field-full">
              <mat-label>Address</mat-label>
              <input matInput formControlName="mainAddress" placeholder="Enter address">
              <mat-icon matPrefix>location_on</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Address Type</mat-label>
              <mat-select formControlName="mainAddressType">
                <mat-option [value]="AddressTypeLvo.HOME">Home</mat-option>
                <mat-option [value]="AddressTypeLvo.WORK">Work</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

      </form>
    </mat-card-content>
  </mat-card>
</div>